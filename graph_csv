import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.widgets import Slider
import matplotlib.ticker as plticker
from datetime import datetime

# Create a dataframe from csv
df = pd.read_csv('data/output.csv', delimiter=',')# Open file.csv generated by pupil_track_ui.py

ts = df['timestamp']
xs = df['xpos']
ys = df['ypos']
intervals = 1.0
loc = plticker.MultipleLocator(base=intervals)
figure, axis = plt.subplots(2, 1,sharex=True)
axis[0].set_title("Horizontal Displacment")
axis[1].set_title("Vertical Displacement")
axis[0].plot(ts,xs)
axis[1].plot(ts,ys)
axis[0].xaxis.set_major_locator(loc)
axis[1].xaxis.set_major_locator(loc)
# Set grid to use minor tick locations. 
axis[0].xaxis.grid(which = 'major')
axis[1].xaxis.grid(which = 'major')





slider_color = 'White'
max_pos = df['timestamp'].max()
min_pos = df['timestamp'].min()
axis_position = plt.axes([0.2, 0.1, 0.65, 0.03],facecolor = slider_color)
slider_position = Slider(axis_position,'Pos', min_pos, max_pos-20)
#find a way to make gridlines be on seconds

# update() function to change the graph when the
# slider is in use
def update(val):
    pos = slider_position.val
    axis[0].set_xlim([pos, pos+20])
    axis[1].set_xlim([pos, pos+20])
    figure.canvas.draw_idle()
 
# update function called using on_changed() function
slider_position.on_changed(update)
plt.show()

